<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CUITChat-AI</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Segoe UI", Tahoma, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100vh;
            background-image: url('images/background.jpg'); /* 背景图片路径 */
            background-size: cover;      /* 让图片铺满屏幕 */
            background-position: center; /* 居中 */
            background-attachment: fixed;/* 滚动时背景固定 */
        }
        header {
            background-color: rgba(16, 163, 127, 0.85); /* 半透明 */
            color: white;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
        }
        #chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .message {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: 8px;
            line-height: 1.4;
            white-space: pre-wrap;
        }
        .user {
            align-self: flex-end;
            background-color: rgba(220, 248, 198, 0.9);
        }
        .ai {
            align-self: flex-start;
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #ddd;
        }
        #input-area {
            display: flex;
            padding: 35px;
            background: rgba(255, 255, 255, 0.85);
            border-top: 1px solid #ddd;
        }
        #prompt {
            flex: 1;
            padding: 30px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            resize: none;
        }
        button {
            background-color: #10a37f;
            color: white;
            border: none;
            padding: 0 20px;
            margin-left: 10px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0e8c6b;
        }
    </style>
</head>
<body>
<header>CUITChat-AI</header>

<div id="chat-container"></div>

<div id="input-area">
    <textarea id="prompt" rows="1" placeholder="输入你的问题..."></textarea>
    <button onclick="send()">发送</button>
</div>

<script>
    const chatContainer = document.getElementById("chat-container");
    const promptInput = document.getElementById("prompt");

    function appendMessage(role, text) {
        const div = document.createElement("div");
        div.className = `message ${role}`;
        div.textContent = text;
        chatContainer.appendChild(div);
        chatContainer.scrollTop = chatContainer.scrollHeight;
        return div;
    }

    function send() {
        const prompt = promptInput.value.trim();
        if (!prompt) return;
        promptInput.value = "";

        appendMessage("user", prompt);
        const aiMsg = appendMessage("ai", "");

        const source = new EventSource(`/ai/stream?prompt=${encodeURIComponent(prompt)}`);

        source.onmessage = (event) => {
            aiMsg.textContent += event.data;
            chatContainer.scrollTop = chatContainer.scrollHeight;
        };

        source.onerror = () => {
            source.close();
        };
    }
</script>
</body>
</html>
